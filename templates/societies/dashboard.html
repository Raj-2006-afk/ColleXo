{% extends "base.html" %}

{% block title %}Society Dashboard{% endblock %}

{% block content %}
<div class="container">
    <nav>
        <ul class="breadcrumb">
            {% for crumb in breadcrumbs %}
            <li class="breadcrumb-item {% if crumb.active %}active{% endif %}">
                {% if crumb.url %}
                    <a href="{{ crumb.url }}">{{ crumb.title }}</a>
                {% else %}
                    {{ crumb.title }}
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </nav>
    
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1>{{ society.name }} - Dashboard</h1>
        
        {% if society.is_approved %}
            <span class="badge badge-success" style="font-size: 1rem; padding: 0.5rem 1rem;">Approved</span>
        {% else %}
            <span class="badge badge-warning" style="font-size: 1rem; padding: 0.5rem 1rem;">Pending Approval</span>
        {% endif %}
    </div>
    
    <!-- Quick Actions -->
    <div style="margin-bottom: 2rem;">
        <a href="{{ url_for('students.society_profile', slug=society.slug) }}" class="btn btn-outline-primary" target="_blank">
            View Public Profile
        </a>
        <a href="{{ url_for('societies.edit_profile') }}" class="btn btn-secondary">
            Edit Profile
        </a>
        {% if society.is_approved %}
        <a href="{{ url_for('societies.create_form') }}" class="btn btn-success">
            Create New Form
        </a>
        {% endif %}
    </div>
    
    <!-- Statistics -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-card-value">{{ total_forms }}</div>
            <div class="stat-card-label">Total Forms</div>
        </div>
        <div class="stat-card" style="border-left-color: #10b981;">
            <div class="stat-card-value">{{ active_forms }}</div>
            <div class="stat-card-label">Active Forms</div>
        </div>
        <div class="stat-card" style="border-left-color: #f59e0b;">
            <div class="stat-card-value">{{ total_responses }}</div>
            <div class="stat-card-label">Total Submissions</div>
        </div>
        <div class="stat-card" style="border-left-color: #06b6d4;">
            <div class="stat-card-value">{{ society.views_count }}</div>
            <div class="stat-card-label">Profile Views</div>
        </div>
    </div>
    
    <!-- Recent Forms -->
    <div class="card">
        <div class="card-body" style="padding: 2rem;">
            <h2>Recent Forms</h2>
            
            {% if recent_forms %}
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Form Title</th>
                            <th>Status</th>
                            <th>Submissions</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for form in recent_forms %}
                        <tr>
                            <td><strong>{{ form.title }}</strong></td>
                            <td>
                                {% if form.is_active %}
                                    <span class="badge badge-success">Active</span>
                                {% else %}
                                    <span class="badge badge-secondary">Inactive</span>
                                {% endif %}
                            </td>
                            <td>{{ form.submissions_count }}</td>
                            <td>{{ form.created_at.strftime('%b %d, %Y') }}</td>
                            <td>
                                <a href="{{ url_for('societies.view_form', form_id=form.id) }}" class="btn btn-sm btn-primary">
                                    View Details
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="text-muted text-center" style="padding: 2rem 0;">
                No forms created yet. {% if society.is_approved %}<a href="{{ url_for('societies.create_form') }}">Create your first form</a>{% else %}Wait for admin approval to create forms.{% endif %}
            </p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
